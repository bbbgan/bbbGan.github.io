<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="445px" preserveAspectRatio="none" style="width:709px;height:445px;background:#FFFFFF;" version="1.1" viewBox="0 0 709 445" width="709px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="177.772" style="stroke:#181818;stroke-width:1.0;" width="10" x="477" y="211.8921"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="150" x2="150" y1="39.1201" y2="407.6641"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="336" x2="336" y1="39.1201" y2="407.6641"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="482" x2="482" y1="39.1201" y2="407.6641"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="625" x2="625" y1="39.1201" y2="407.6641"/><rect fill="#FFFFCC" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="115" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="122" y="28.0439">Acceptor</text><rect fill="#FFFFCC" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="115" y="406.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="122" y="429.708">Acceptor</text><rect fill="#FFFFCC" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80" x="296" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="303" y="28.0439">TcpServer</text><rect fill="#FFFFCC" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80" x="296" y="406.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="303" y="429.708">TcpServer</text><rect fill="#FFFFCC" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="427" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="434" y="28.0439">TcpConnection</text><rect fill="#FFFFCC" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110" x="427" y="406.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="434" y="429.708">TcpConnection</text><rect fill="#FFFFCC" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156" x="547" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="554" y="28.0439">EventLoopThreadPool</text><rect fill="#FFFFCC" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156" x="547" y="406.6641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="554" y="429.708">EventLoopThreadPool</text><rect fill="#FFFFFF" height="177.772" style="stroke:#181818;stroke-width:1.0;" width="10" x="477" y="211.8921"/><polygon fill="#181818" points="613,68.8745,623,72.8745,613,76.8745,617,72.8745" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="336" x2="619" y1="72.8745" y2="72.8745"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="409" y="68.0181">setThreadNum() &amp; start()</text><polygon fill="#181818" points="161,103.6289,151,107.6289,161,111.6289,157,107.6289" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="155" x2="335" y1="107.6289" y2="107.6289"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="223.5" y="102.7725">listen()</text><path d="M26,85.8745 L26,112.8745 L145,112.8745 L145,95.8745 L135,85.8745 L26,85.8745 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M135,85.8745 L135,95.8745 L145,95.8745 L135,85.8745 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="32" y="105.7725">wait for tcp client</text><polygon fill="#181818" points="324,141.3833,334,145.3833,324,149.3833,328,145.3833" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="150" x2="330" y1="145.3833" y2="145.3833"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="162" y="140.5269">onNewConnectionCallback()</text><path d="M5,123.6289 L5,150.6289 L145,150.6289 L145,133.6289 L135,123.6289 L5,123.6289 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M135,123.6289 L135,133.6289 L145,133.6289 L135,123.6289 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="11" y="143.5269">a new client come in</text><polygon fill="#181818" points="470,176.1377,480,180.1377,470,184.1377,474,180.1377" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:2.0;stroke-dasharray:2.0,2.0;" x1="336" x2="476" y1="180.1377" y2="180.1377"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="375" y="175.2813">&lt;&lt;create&gt;&gt;</text><polygon fill="#181818" points="465,207.8921,475,211.8921,465,215.8921,469,211.8921" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="336" x2="471" y1="211.8921" y2="211.8921"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="345.5" y="207.0356">connectEstablished()</text><polygon fill="#181818" points="613,239.6465,623,243.6465,613,247.6465,617,243.6465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="487" x2="619" y1="243.6465" y2="243.6465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="538" y="238.79">send()</text><polygon fill="#181818" points="498,271.4009,488,275.4009,498,279.4009,494,275.4009" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="492" x2="624" y1="275.4009" y2="275.4009"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="523" y="270.5444">handRead()</text><polygon fill="#181818" points="498,306.1553,488,310.1553,498,314.1553,494,310.1553" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="492" x2="624" y1="310.1553" y2="310.1553"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="523" y="305.2988">handRead()</text><path d="M630,288.4009 L630,315.4009 L691,315.4009 L691,298.4009 L681,288.4009 L630,288.4009 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M681,288.4009 L681,298.4009 L691,298.4009 L681,288.4009 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="636" y="308.2988">read 0</text><line style="stroke:#181818;stroke-width:2.0;" x1="487" x2="529" y1="344.9097" y2="344.9097"/><line style="stroke:#181818;stroke-width:2.0;" x1="529" x2="529" y1="344.9097" y2="357.9097"/><line style="stroke:#181818;stroke-width:2.0;" x1="488" x2="529" y1="357.9097" y2="357.9097"/><polygon fill="#181818" points="498,353.9097,488,357.9097,498,361.9097,494,357.9097" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="494" y="340.0532">handClose()</text><polygon fill="#181818" points="347,385.6641,337,389.6641,347,393.6641,343,389.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:2.0;" x1="341" x2="481" y1="389.6641" y2="389.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="364.5" y="384.8076">closeCallback()</text><line style="stroke:#A80036;stroke-width:2.0;" x1="473" x2="491" y1="380.6641" y2="398.6641"/><line style="stroke:#A80036;stroke-width:2.0;" x1="473" x2="491" y1="398.6641" y2="380.6641"/><!--MD5=[b14339edb9c10d924c771e4a84717f40]
@startuml server

skinparam sequenceArrowThickness 2
skinparam sequenceMessageAlign center

skinparam ActorBackgroundColor BUSINESS
skinparam ParticipantBackgroundColor BUSINESS



participant Acceptor
participant TcpServer
participant TcpConnection

TcpServer -> EventLoopThreadPool : setThreadNum() & start()
TcpServer -> Acceptor : listen()
note left
wait for tcp client
end note
Acceptor -> TcpServer : onNewConnectionCallback()

note left
a new client come in
end note

TcpServer - -> TcpConnection : <<create>>
TcpServer -> TcpConnection : connectEstablished()

activate TcpConnection
TcpConnection -> EventLoopThreadPool : send()
EventLoopThreadPool -> TcpConnection : handRead()
EventLoopThreadPool -> TcpConnection : handRead()

note right
read 0 
end note
TcpConnection -> TcpConnection : handClose()
TcpConnection -> TcpServer : closeCallback()

destroy TcpConnection

@enduml

PlantUML version 1.2022.7(Tue Aug 23 01:01:30 CST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>